

module Ad
  (
    
    ad'
    
  ) where


import BasicData

ad' :: Char -> S -> [S]
ad' c s = ad c True (s,[]) s

ad :: Char -> Bool -> (S,[S]) -> S -> [S]

----------------------------------------------------------------

ad c bl (st,ans) (M (Lp '(') (Op '*') (V (Var a)) (V (Var b)) (Rp ')') )
  | (c == a) && (c == b) && (bl == True )  = [(V (Var a))] ++ [(V (Var b))]
  | (c == a) && (c == b) && (bl == False)  = [ret a st] ++ [ret b st]
  
  
------------------------------------------------------------------
                                             
ad c bl (st,ans) (M (Lp '(') (Op '*') a (V (Var b)) (Rp ')') )
  | (c == b) && (bl == True) = (ad c False ((V (Var b)),ans) a) ++ [a]
  | (c == b) && (bl ==False) = (ad c bl (ret b st,ans) a) ++ [ret' a st]
  
------------------------------------------------------------------

ad c bl (st,ans) (M (Lp '(') (Op '*') (V (Var a)) b (Rp ')') )
  | (c == a) && (bl == True)  = (ad c False ((V (Var a)),ans) b) ++ [b]
  | (c == a) && (bl == False) = (ad c bl (ret a st,ans) b) ++ [ ret' b st ]
  
  
------------------------------------------------------------------

ad c bl (st,ans) (M (Lp '(') (Op '*') l r (Rp ')') )
  | bl == True  = (ad c False (r,ans) l) ++ (ad c False (l,ans) r)
  | bl == False = (ad c bl (ret' st r,ans) l) ++ (ad c bl (ret' st l,ans) r)
  
  
----------------------------------------------------------------
----------------------------------------------------------------       
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------

ad c bl (st,ans) (M (Lp '(') (Op '+') (V (Var a)) (V (Var b)) (Rp ')') )
  | (c == a) && (c == b) && (bl == True) = [N (Nun 1)] ++ [N (Nun 1)]
  | (c == a) && (c == b) && (bl ==False) = [st] ++ [st]
    
------------------------------------------------------------------

ad c bl (st,ans) (M (Lp '(') (Op '+') (V (Var a)) b (Rp ')') )
  | (bl == False) && (c == a) = [st]
  | (bl == True ) && (c == a) = [N (Nun 1)]
  
------------------------------------------------------------------

ad c bl (st,ans) (M (Lp '(') (Op '+') a (V (Var b)) (Rp ')') )
  | (bl == False) && (c == b) = [st]
  | (bl == True ) && (c == b) = [N (Nun 1)]
  
------------------------------------------------------------------

ad c bl s (M (Lp '(') (Op '+') a b (Rp ')') )
  = (ad c bl s a) ++ (ad c bl s b)
  
----------------------------------------------------------------

ad _ _ _ _ = []

----------------------------------------------------------------


ret :: Char -> S -> S
ret a st = (M (Lp '(') (Op '*') st (V (Var a)) (Rp ')') )

ret' :: S -> S -> S
ret' st l = (M (Lp '(') (Op '*') st l (Rp ')') )

